# 本项目技术指标对比分析与智能体提示词

本文档提炼项目内用到的全部技术指标，给出定义、计算方式、解读规则，并整理成可直接放入「系统提示词 / 用户提示词」的段落，供智能体（LLM Agent）做技术面分析时使用。

---

## 一、指标总览与分类

| 类别 | 指标 | 主要用途 | 本项目参数 |
|------|------|----------|------------|
| 趋势 | MA5/10/20/60、多头排列 | 方向、支撑/阻力、趋势强弱 | 简单移动平均 SMA |
| 趋势/动量 | MACD | 多空、金叉死叉、零轴 | 12, 26, 9 |
| 动量/超买超卖 | KDJ | 超买超卖、钝化 | 9, 3, 3 |
| 动量/超买超卖 | RSI | 超买超卖、背离 | 14 |
| 波动 | ATR、ATR% | 止损、仓位、波动幅度 | 14 |
| 量能 | 量比（volume_ratio） | 放量/缩量、突破有效性 | 近期量/20日均量 |
| 结构 | 近期高点（20日） | 阻力、突破 | 过去约20根K线最高价 |

---

## 二、各指标详细说明

### 1. 均线（MA）

- **计算**：收盘价 Close 的简单移动平均。  
  - MA5 = 最近 5 根 K 线收盘价均值  
  - MA10 / MA20 / MA60 同理。
- **输出字段**：price（当前价）, ma5, ma10, ma20, ma60, above_ma5/20/60, daily_long_align。
- **解读**：
  - **多头排列**：价格 > MA5 > MA10 > MA20 > MA60 → 趋势偏多、结构强。
  - **空头排列**：相反 → 趋势偏空。
  - 价格在 MA20 之上：短期偏多；在 MA60 之上：中期偏多。
  - MA20/MA60 常作支撑：跌破 MA20 可视为减仓区，跌破 MA60 可视为离场参考。

### 2. MACD（指数平滑异同移动平均线）

- **计算**（本项目）：  
  - 快线 EMA(Close, 12)，慢线 EMA(Close, 26)。  
  - MACD 线 = 快线 - 慢线。  
  - 信号线 = MACD 线的 9 日 EMA。  
  - 柱状图 = MACD 线 - 信号线。
- **输出字段**：macd, signal, histogram, above_zero, golden_cross。
- **解读**：
  - **above_zero**：MACD 线 > 0 → 偏多；< 0 → 偏空。
  - **golden_cross**：MACD 线由下上穿信号线 → 金叉，偏多信号。
  - **死叉**：MACD 线由上穿下信号线 → 偏空信号（本项目未单独布尔输出，可由 macd < signal 推断）。
  - 柱状图由负转正/由正转负可辅助判断动能变化。

### 3. KDJ（随机指标）

- **计算**（本项目）：  
  - RSV = (Close - 9 日最低) / (9 日最高 - 9 日最低) × 100。  
  - K = RSV 的 3 日 EMA，D = K 的 3 日 EMA，J = 3K - 2D。
- **输出字段**：k, d, j, overbought（K>80）, oversold（K<20）。
- **解读**：
  - **超买**：K > 80 → 短期可能回调，不宜追高。
  - **超卖**：K < 20 → 短期可能反弹，可关注低吸。
  - **钝化**：强势行情中 K 可长期 >80；弱势中 K 可长期 <20，需结合趋势与 RSI 综合判断。
  - J 值最敏感，K、D 金叉/死叉可辅助短多短空。

### 4. RSI（相对强弱指数）

- **计算**（本项目）：  
  - 涨跌幅：delta = Close - Close_前。  
  - 涨幅均值 avg_gain、跌幅均值 avg_loss（EMA，α=1/14）。  
  - RS = avg_gain / avg_loss，RSI = 100 - 100/(1+RS)。
- **输出字段**：rsi, overbought（>70）, oversold（<30）。
- **解读**：
  - **超买**：RSI > 70 → 短期可能回调。
  - **超卖**：RSI < 30 → 短期可能反弹。
  - **中性**：30～70，结合趋势与 KDJ 判断多空。
  - **背离**：价格创新高而 RSI 未创新高（顶背离）或价格创新低而 RSI 未创新低（底背离）可作辅助信号（本项目未自动计算，智能体可结合多日数据口头提及）。

### 5. ATR 与 ATR%

- **计算**：  
  - TR = max(High-Low, |High-前收|, |Low-前收|)。  
  - ATR(14) = TR 的 14 日简单移动平均。  
  - ATR% = ATR / 当前收盘价 × 100。
- **输出字段**：atr, atr_pct（在 tech_levels 中）。
- **解读**：
  - **波动**：ATR 越大波动越大；ATR% 便于跨标的比较（如 ATR%=2 表示约 2% 的日波动）。
  - **止损**：常用「收盘价 - N×ATR」作止损位，本项目默认 N=1.5（可配置 TECH_ATR_STOP_MULT）。
  - **仓位**：波动大时（ATR% 高）可建议轻仓或缩小仓位。

### 6. 量比（Volume Ratio）

- **计算**：近期一根 K 线的成交量 / 过去 20 根 K 线成交量均值（20 日均量）。
- **输出字段**：volume_ratio, volume_ma20（在 volume_context 中）。
- **解读**：
  - **量比 > 1**：当前量能高于近期均量，放量。
  - **量比 < 1**：缩量。
  - **放量突破**：价格突破近期高点且量比 ≥ 阈值（本项目默认 1.5，TECH_VOLUME_BREAKOUT_RATIO）→ 突破更可信，可作入场加强条件。
  - 放量下跌需警惕；缩量上涨可持续性存疑。

### 7. 近期高点（20 日）、入场/离场参考

- **计算**：过去约 20 根 K 线内的最高价作为阻力参考；MA20/MA60 作为支撑参考；ATR 止损 = 价格 - N×ATR。
- **输出字段**：support_ma20, support_ma60, resistance_20d, entry_note, exit_note。
- **解读**：
  - **入场**：突破/站稳 MA20、或突破近期高点；若同时放量（量比≥阈值）更佳。
  - **离场**：跌破 MA20 考虑减仓，跌破 MA60 考虑离场；或收盘跌破「价格 - N×ATR」止损。

---

## 三、指标对比与组合使用

| 维度 | 更适用的指标 | 说明 |
|------|--------------|------|
| 趋势方向 | MA、多头排列、MACD 零轴 | 判断多空与趋势强度 |
| 短期超买超卖 | KDJ、RSI | 两者可互相印证；同时超买/超卖时信号更强 |
| 动能/金叉死叉 | MACD | 金叉偏多、死叉偏空，结合零轴 |
| 波动与风控 | ATR、ATR% | 止损位、仓位大小 |
| 突破有效性 | 量比 + 近期高点 | 放量突破更可靠 |
| 综合一句话 | tech_status_one_line | 项目已生成一句摘要，智能体可直接引用并展开 |

**组合建议**：趋势（MA/MACD）+ 超买超卖（KDJ/RSI）+ 量能（量比）+ 波动（ATR%）一起看，避免单指标结论；入场/离场参考（entry_note/exit_note）可直接用于「加仓价/减仓价」表述。

---

## 四、智能体提示词（可直接放入 System 或 User）

以下段落可直接作为「技术面分析」的系统提示或用户说明，粘贴到智能体提示词中使用。

```
【技术指标定义与解读规则】

你分析技术面时，将使用以下指标（数据由系统提供，你只需按规则解读并输出结论）：

1) 均线（MA）
- MA5/10/20/60：收盘价的 5/10/20/60 周期简单移动平均。
- 多头排列：当前价 > MA5 > MA10 > MA20 > MA60 → 趋势偏多、结构强；反之为空头或非多头。
- 价格在 MA20 之上视为短期偏多，在 MA60 之上视为中期偏多；跌破 MA20 可考虑减仓，跌破 MA60 可考虑离场。

2) MACD（12,26,9）
- MACD 线 = EMA12(Close) - EMA26(Close)；信号线 = MACD 的 9 日 EMA；柱状图 = MACD - 信号线。
- MACD 在零轴上方：偏多；下方：偏空。MACD 线刚上穿信号线：金叉，偏多信号；下穿：死叉，偏空信号。

3) KDJ（9,3,3）
- K>80：超买，短期可能回调；K<20：超卖，短期可能反弹。K 在 20～80 为中性，结合趋势判断。长期停留在超买/超卖区为钝化。

4) RSI（14）
- RSI>70：超买；RSI<30：超卖；30～70：中性。可与 KDJ 互相印证；两者同时超买或超卖时结论更稳。

5) ATR 与 ATR%
- ATR(14)：真实波幅的 14 日均。ATR% = ATR/收盘价×100，表示日波动幅度百分比。
- 用于止损：常见为「收盘跌破 当前价 - N×ATR」离场（N 如 1.5）。ATR% 大时宜轻仓或缩小仓位。

6) 量比
- 量比 = 当前成交量 / 20 日均量。>1 为放量，<1 为缩量。
- 价格突破近期高点且量比≥1.5（可配置）时，视为放量突破，突破更可信，可作入场加强条件。放量下跌需警惕。

7) 入场/离场参考（系统已生成）
- 系统会给出 entry_note（入场参考）与 exit_note（离场参考），基于 MA20/MA60、近期高点、ATR 止损与量比。你在输出「加仓价格」「减仓价格」时，应尽量与这两条一致或在其基础上略作说明。

8) 技术面一句摘要（tech_status_one_line）
- 系统会提供一句已汇总的结论（如：日线多头排列；MACD金叉；KDJ中性；RSI中性(45)；量比1.2；ATR%2.5%）。你可直接引用并在此基础上用 1～2 句展开「趋势结构」「MACD状态」「KDJ状态」等，保持与数据一致。

输出要求：根据以上指标综合给出「趋势结构」「MACD状态」「KDJ状态」的简短描述，并据此参与评分与交易动作（买入/观察/离场）；加仓价与减仓价尽量对齐系统给出的入场/离场参考。
```

---

## 五、简短版（占位少的提示词）

若提示词长度受限，可使用下面精简版：

```
技术面解读规则：多头排列(价>MA5>MA10>MA20>MA60)偏多；MACD 零轴上/金叉偏多；KDJ K>80 超买、K<20 超卖；RSI>70 超买、<30 超卖；量比>1 放量，放量突破近期高点更佳；ATR% 用于止损与仓位。加仓/减仓价以系统给出的 entry_note/exit_note 为准，可引用 tech_status_one_line 一句摘要后略作展开。
```

---

## 六、本项目输出字段与提示词对应关系

| 系统输出字段 | 智能体可如何使用 |
|--------------|------------------|
| trend_ma（price, ma5~ma60, above_ma*, daily_long_align） | 描述趋势、是否多头排列、价格与均线关系 |
| macd_summary（macd, signal, histogram, above_zero, golden_cross） | 描述 MACD 状态、是否金叉、零轴上下 |
| kdj_summary（k, d, j, overbought, oversold） | 描述 KDJ 超买超卖或中性、是否钝化 |
| rsi_summary（rsi, overbought, oversold） | 描述 RSI 超买超卖或中性 |
| volume_context（volume_ratio, volume_ma20） | 描述放量/缩量、是否放量突破 |
| tech_levels（atr, atr_pct, entry_note, exit_note, resistance_20d） | 描述波动、直接引用入场/离场与加仓/减仓价 |
| tech_status_one_line | 直接引用一句摘要，再 1～2 句展开 |

将上述「智能体提示词」段落放入你的 Agent 系统提示或技术面分析专用提示中即可；若接口传入了上述字段，智能体按本规则解读并输出即可与项目逻辑一致。
